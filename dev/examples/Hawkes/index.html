<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hawkes · PointProcesses.jl</title><meta name="title" content="Hawkes · PointProcesses.jl"/><meta property="og:title" content="Hawkes · PointProcesses.jl"/><meta property="twitter:title" content="Hawkes · PointProcesses.jl"/><meta name="description" content="Documentation for PointProcesses.jl."/><meta property="og:description" content="Documentation for PointProcesses.jl."/><meta property="twitter:description" content="Documentation for PointProcesses.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="PointProcesses.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="PointProcesses.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PointProcesses.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../Basics/">Basics</a></li><li class="is-active"><a class="tocitem" href>Hawkes</a><ul class="internal"><li><a class="tocitem" href="#A-Quick-Recap-of-Hawkes-Processes"><span>A Quick Recap of Hawkes Processes</span></a></li></ul></li><li><a class="tocitem" href="../Inhomogeneous/">Inhomogeneous</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Hawkes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hawkes</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JoseKling/PointProcesses.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JoseKling/PointProcesses.jl/blob/main/docs/examples/Hawkes.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fitting-data-to-a-Hawkes-Process-Model"><a class="docs-heading-anchor" href="#Fitting-data-to-a-Hawkes-Process-Model">Fitting data to a Hawkes Process Model</a><a id="Fitting-data-to-a-Hawkes-Process-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-data-to-a-Hawkes-Process-Model" title="Permalink"></a></h1><p>This tutorial demonstrates how to fit data to a Hawkes point process model using maximum likelihood estimation (MLE). We will go over the basics of Hawkes processes, why they are useful, and how to implement them in PointProcesses.jl. We will first begin with a recap of the math of a general Hawkes process.</p><h2 id="A-Quick-Recap-of-Hawkes-Processes"><a class="docs-heading-anchor" href="#A-Quick-Recap-of-Hawkes-Processes">A Quick Recap of Hawkes Processes</a><a id="A-Quick-Recap-of-Hawkes-Processes-1"></a><a class="docs-heading-anchor-permalink" href="#A-Quick-Recap-of-Hawkes-Processes" title="Permalink"></a></h2><p>A Hawkes process is a type of temporal point process that models self-exciting behavior, where the occurrence of an event increases the likelihood of future events occurring in the near future. The intensity function of a general Hawkes process is given by: <span>$λ(t|\mathcal H_t) = μ(t) + ∑_{tᵢ &lt; t} \phi(t - tᵢ)$</span> where μ(t) is the baseline intensity, which accounts for spontaneous events, <span>$\mathcal H_t$</span> is the history of events up until time <span>$t$</span>, and <span>$\phi(\cdot)$</span> is the triggering kernel, which controls how past events influence future events.</p><p>One of the most common choices for this kernel is the exponential function: <span>$\phi(s) = \alpha\exp{-\beta s}$</span>. In this model, α is the strength of self-exciting, and β controls the rate of excitation decay. Given these parameters, the intensity function is: <span>$λ(t|\mathcal H_t) = μ + \sum_{t_i &lt; t} \alpha \exp{-\beta (t - t_i)}$</span>. We assume that μ is constant for simplicity. But, we could generalize this to be inhomogeneous.</p><p>An important statistic of the Hawkes process is the branching ratio which is a measure of the expected number of &quot;daughter&quot; events, a &quot;parent&quot; event will create. For the exponential kernel, this is given by the following equation: <span>$n = \frac{\alpha}{\beta}$</span>. In the event that n &lt; 1, the process is subcritical, meaning that events will eventually die out. If n = 1, the process is critical, and if n &gt; 1, the process is supercritical, meaning that events can lead to an infinite cascade of events.</p><p>Let&#39;s now apply this theory, and develop more through the process, by fitting a Hawkes process to some data.</p><pre><code class="language-julia hljs">using Clustering
using CSV
using DataFrames
using Dates
using Distributions
using PointProcesses
using Plots</code></pre><p>First let&#39;s open our data. This data records litter box entries taken from three cats over a period of one month.</p><pre><code class="language-julia hljs">root = pkgdir(PointProcesses)
data = CSV.read(joinpath(root, &quot;docs&quot;, &quot;examples&quot;, &quot;data&quot;, &quot;cats.csv&quot;), DataFrame);</code></pre><p>This dataset has three cats in it, so let&#39;s first separate out each cat, using their weight to infer their identity</p><pre><code class="language-julia hljs">cat_weights = [parse(Float64, split(i)[1]) for i in data.Value]
clusters = kmeans(reshape(cat_weights, 1, :), 3; maxiter=100, display=:none)

data.CatWeight = cat_weights
data.CatID = clusters.assignments;</code></pre><p>Now that we have set this up we need to get the timestamps in a useable order for plotting. We can use the Dates package for this.</p><pre><code class="language-julia hljs">fmt = dateformat&quot;m/d I:M p&quot;
dt = DateTime(&quot;12/22 3:09 pm&quot;, fmt)

function parse_timestamp_min(s::AbstractString; year=2024)
    dt = DateTime(s, dateformat&quot;m/d I:M p&quot;)
    DateTime(year, month(dt), day(dt), hour(dt), minute(dt))
end

data.TimestampDT = parse_timestamp_min.(String.(data.Timestamp))

t0 = minimum(data.TimestampDT)
data.t = (data.TimestampDT .- t0) ./ Minute(1)  # Float64 minutes since first event</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">268-element Vector{Float64}:
 38752.0
 38403.0
 38370.0
 38349.0
 37929.0
 37596.0
 37543.0
 37451.0
 37386.0
 36944.0
     ⋮
   875.0
   411.0
   395.0
   394.0
   345.0
   262.0
   108.0
    39.0
     0.0</code></pre><p>Since this dataset only has resolution up to the nearest minute, we need to check if there are any &quot;ties&quot; as the Hawkes process model requires unique event times.</p><pre><code class="language-julia hljs">if any(diff(sort(data.t)) .== 0)
    println(
        &quot;Data contains tied event times. Please add small jitter to event times to make them unique.&quot;,
    )
else
    println(&quot;Data contains no tied event times. Proceed with fitting. Yay!&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Data contains no tied event times. Proceed with fitting. Yay!</code></pre><p>Great! We can now move forward. First, let&#39;s visualize the data using a simple event plot.</p><pre><code class="language-julia hljs">function eventplot(
    event_times::Vector{Float64};
    title=&quot;Event Plot&quot;,
    xlabel=&quot;Time (minutes)&quot;,
    ylabel=&quot;Events&quot;,
)
    scatter(
        event_times,
        ones(length(event_times));
        markershape=:vline,
        markersize=10,
        label=&quot;&quot;,
        title=title,
        xlabel=xlabel,
        ylabel=ylabel,
        yticks=false,
    )
end

cat1_times = data.t[data.CatID .== 1]
cat2_times = data.t[data.CatID .== 2]
cat3_times = data.t[data.CatID .== 3]

p1 = eventplot(cat1_times; title=&quot;Cat 1 Litter Box Entries&quot;)
p2 = eventplot(cat2_times; title=&quot;Cat 2 Litter Box Entries&quot;)
p3 = eventplot(cat3_times; title=&quot;Cat 3 Litter Box Entries&quot;)

plot(p1, p2, p3; layout=(3, 1), size=(800, 600))</code></pre><img src="44d497e6.svg" alt="Example block output"/><p>From the plot above, we can see that events qualitatively arrive together. This could mean that if one cat uses the litter box, then another is soon to follow. To further understand the data, let&#39;s plot the intensity function for the average day. We can use the Inhomogeneous Poisson Process models in PointProcesses.jl to fit a piecewise constant intensity function to the data. This will give us an idea of the average litter box usage over the course of a day. While this will not give us any information about self-exciting behavior, it will help us understand the daily patterns of litter box usage.</p><pre><code class="language-julia hljs">tod = minute.(data.TimestampDT) .+ 60 .* hour.(data.TimestampDT) # time-of-day in minutes since midnight
day = Date.(data.TimestampDT)
n_days = length(unique(day))
h_day = History(sort(Float64.(tod)), 0.0, 1440.0) # build a &quot;history&quot; on [0, 1440] minutes
nbins = 96  # 96 bins = 15-minute bins
pp_day = fit(
    InhomogeneousPoissonProcess{PiecewiseConstantIntensity{Float64},Dirac{Nothing}},
    h_day,
    nbins,
)

λ_avg(u) = pp_day.intensity_function(u) / n_days

u = range(0.0, 1440.0; length=2000)
plot(
    u ./ 60,
    λ_avg.(u);
    xlabel=&quot;Time of day (hours)&quot;,
    ylabel=&quot;Empirical intensity (events/min)&quot;,
    title=&quot;Average-day empirical intensity (piecewise constant)&quot;,
    legend=false,
)</code></pre><img src="d4ad3235.svg" alt="Example block output"/><p>From the plot we can see the intensity function has two peaks, one at around 7-10 AM and the other at 8-10 PM. Now, let&#39;s fit a Hawkes process to the data. We will for now, ignore the cat identities and fit a single Hawkes process to all the data. The goal of this analysis is to understand the self-exciting nature of the litter box entries. I.e., if one cat uses the litter box, does that increase the likelihood of another cat using it soon after? To do this, we can use the implementation in PointProcesses.jl</p><pre><code class="language-julia hljs">full_history = History(data.t, 0.0, maximum(data.t) + 1.0)
hawkes_model = fit(HawkesProcess, full_history)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Fitted Hawkes Process Parameters:
Base intensity (μ): 0.0039651676023376575
Excitation parameter (α): 0.0166917260580213
Decay rate (ω): 0.03912424622258603
Branching ratio (n = α/ω): 0.4266338056216745</code></pre><p>We can now evaluate the branching ratio and parameters of the fitted model. The branching ratio tells us the expected number of &quot;daughter&quot; events that a &quot;parent&quot; event will create. If this value is significantly greater than 0, it suggests that the litter box entries are self-exciting, meaning that one entry increases the likelihood of subsequent entries in the near future. If the branching ratio is close to 0, it suggests that the entries are more random and not influenced by previous entries. In this case, we can see that the branching ratio is around 0.42, suggesting a moderate level of self-excitation in the litter box entries. Finally, we can visualize the fitted intensity function over time.</p><pre><code class="language-julia hljs">ts = sort(data.t)

function λ_hawkes(t::Real)
    hawkes_model.μ +
    sum((hawkes_model.α * exp(-hawkes_model.ω * (t - ti)) for ti in ts if ti &lt; t); init=0.0)
end

u = range(0.0, maximum(ts) + 1.0; length=2000)

plot(
    u,
    λ_hawkes.(u);
    xlabel=&quot;Time (minutes)&quot;,
    ylabel=&quot;Fitted Hawkes intensity (events/min)&quot;,
    title=&quot;Fitted Hawkes Process Intensity Function&quot;,
    legend=false,
)</code></pre><img src="be471f7b.svg" alt="Example block output"/><p>From the plot, we can observe how the intensity function varies over time, capturing the self-exciting nature of the litter box entries. Like any good statistical analysis, it is important to assess goodness of fit. We will rely on the most useful method in point processes: the time-rescaling theorem. Luckily, PointProcesses.jl has inbuilt functionality to assess goodness of fit using this theorem. We will use a Monte Carlo test to compare the empirical KS distance of the rescaled times against simulated data from the fitted Hawkes process.</p><pre><code class="language-julia hljs">test = MonteCarloTest(KSDistance{Exponential}, hawkes_model, full_history; n_sims=1000)

println(
    &quot;Assuming a significance level of 0.05, we &quot; *
    (p &lt; 0.05 ? &quot;reject&quot; : &quot;fail to reject&quot;) *
    &quot;&quot;,</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Monte Carlo Test p-value for Hawkes Process fit: 0.16383616383616384
Assuming a significance level of 0.05, we fail to reject
the null hypothesis that the Hawkes process is a good fit to the data.</code></pre><p>From this analysis, it seems that we can say that litter-box usage is indeed a self-exciting process, as the fitted Hawkes process provides a good fit to the data. It&#39;s worth considering that we have ignored the identities of the cats in this analysis. A more thorough analysis could involve fitting a multivariate Hawkes process, where each cat is represented as a separate dimension. This would allow us to capture the interactions between the cats more accurately. This will be the subject of a future tutorial.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Basics/">« Basics</a><a class="docs-footer-nextpage" href="../Inhomogeneous/">Inhomogeneous »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 9 January 2026 14:20">Friday 9 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
