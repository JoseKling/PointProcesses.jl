<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hidden Markov models · PointProcesses.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://gdalle.github.io/PointProcesses.jl/tuto/hmm/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="PointProcesses.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="PointProcesses.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PointProcesses.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../history/">Event history</a></li><li><a class="tocitem" href="../point_processes/">Point processes</a></li><li><a class="tocitem" href="../models/">Built-in models</a></li><li><a class="tocitem" href="../markov/">Markov chains</a></li><li class="is-active"><a class="tocitem" href>Hidden Markov models</a><ul class="internal"><li><a class="tocitem" href="#Discrete-time"><span>Discrete time</span></a></li><li><a class="tocitem" href="#Continuous-time"><span>Continuous time</span></a></li></ul></li><li><a class="tocitem" href="../utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../roadmap/">Roadmap</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Hidden Markov models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hidden Markov models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/gdalle/PointProcesses.jl/blob/master/docs/src/tuto/hmm.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Hidden-Markov-models"><a class="docs-heading-anchor" href="#Hidden-Markov-models">Hidden Markov models</a><a id="Hidden-Markov-models-1"></a><a class="docs-heading-anchor-permalink" href="#Hidden-Markov-models" title="Permalink"></a></h1><h2 id="Discrete-time"><a class="docs-heading-anchor" href="#Discrete-time">Discrete time</a><a id="Discrete-time-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-time" title="Permalink"></a></h2><p>Here is an example of the Baum-Welch estimation algorithm applied to a discrete HMM.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using MeasureTheory, PointProcesses, Random; Random.seed!(63)</code><code class="nohighlight hljs ansi" style="display:block;">MersenneTwister(63)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; tr = DiscreteMarkovChain([0.3, 0.7], [0.9 0.1; 0.2 0.8])</code><code class="nohighlight hljs ansi" style="display:block;">DiscreteMarkovChain{Vector{Float64}, Matrix{Float64}}([0.3, 0.7], [0.9 0.1; 0.2 0.8])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; em1 = Dists.Normal(1, 0.3)</code><code class="nohighlight hljs ansi" style="display:block;">Distributions.Normal{Float64}(μ=1.0, σ=0.3)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; em2 = Dists.Normal(2, 0.3)</code><code class="nohighlight hljs ansi" style="display:block;">Distributions.Normal{Float64}(μ=2.0, σ=0.3)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; hmm = HiddenMarkovModel(tr, [em1, em2])</code><code class="nohighlight hljs ansi" style="display:block;">HiddenMarkovModel{DiscreteMarkovChain{Vector{Float64}, Matrix{Float64}}, Distributions.Normal{Float64}}(DiscreteMarkovChain{Vector{Float64}, Matrix{Float64}}([0.3, 0.7], [0.9 0.1; 0.2 0.8]), Distributions.Normal{Float64}[Distributions.Normal{Float64}(μ=1.0, σ=0.3), Distributions.Normal{Float64}(μ=2.0, σ=0.3)])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; states, observations = rand(hmm, 1000)</code><code class="nohighlight hljs ansi" style="display:block;">([1, 1, 1, 1, 1, 1, 1, 1, 1, 1  …  1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [0.9161118148093671, 1.0684154621608728, 0.7753382179464557, 0.6257684386387388, 1.0015892194082963, 1.519963867663214, 1.4791297500316496, 1.2824518797398579, 1.067833908264114, 0.7245353978290396  …  0.6366908951689438, 0.3442302513793023, 1.2451099901116496, 1.4501270477503796, 1.0540951368770008, 1.2396379445811008, 1.1388245703488562, 1.380910711911946, 1.0350573230041205, 0.9665523269487021])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; tr_init = DiscreteMarkovChain(randprobvec(2), randtransmat(2))</code><code class="nohighlight hljs ansi" style="display:block;">DiscreteMarkovChain{Vector{Float64}, Matrix{Float64}}([0.44024580200289837, 0.5597541979971016], [0.1874320544559085 0.8125679455440915; 0.19828554517256944 0.8017144548274305])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; em1_init = Dists.Normal(rand(), 1)</code><code class="nohighlight hljs ansi" style="display:block;">Distributions.Normal{Float64}(μ=0.8520692118711062, σ=1.0)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; em2_init = Dists.Normal(rand(), 1)</code><code class="nohighlight hljs ansi" style="display:block;">Distributions.Normal{Float64}(μ=0.9707898401534842, σ=1.0)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; hmm_init = HiddenMarkovModel(tr_init, [em1_init, em2_init])</code><code class="nohighlight hljs ansi" style="display:block;">HiddenMarkovModel{DiscreteMarkovChain{Vector{Float64}, Matrix{Float64}}, Distributions.Normal{Float64}}(DiscreteMarkovChain{Vector{Float64}, Matrix{Float64}}([0.44024580200289837, 0.5597541979971016], [0.1874320544559085 0.8125679455440915; 0.19828554517256944 0.8017144548274305]), Distributions.Normal{Float64}[Distributions.Normal{Float64}(μ=0.8520692118711062, σ=1.0), Distributions.Normal{Float64}(μ=0.9707898401534842, σ=1.0)])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; hmm_est, logL_evolution = baum_welch(hmm_init, observations, iterations=100)</code><code class="nohighlight hljs ansi" style="display:block;">(HiddenMarkovModel{DiscreteMarkovChain{Vector{Float64}, Matrix{Float64}}, Distributions.Normal{Float64}}(DiscreteMarkovChain{Vector{Float64}, Matrix{Float64}}([1.0, 1.590733939723317e-253], [0.9031154004692189 0.0968845995307811; 0.2339866671829268 0.7660133328170732]), Distributions.Normal{Float64}[Distributions.Normal{Float64}(μ=1.01550579534864, σ=0.31937379465818544), Distributions.Normal{Float64}(μ=1.9888727909655293, σ=0.3107545603081362)]), [-1130.0264918096143, -810.9897110626848, -810.9338784129601, -810.85927677141, -810.7442804228225, -810.5595034454998, -810.2548288747199, -809.7384388553828, -808.8344681778708, -807.1936133152224  …  -583.1517962465811, -583.1517962465812, -583.1517962465814, -583.1517962465817, -583.1517962465816, -583.1517962465816, -583.1517962465815, -583.1517962465817, -583.1517962465815, -583.1517962465816])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; transition_matrix(hmm_est)</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Float64}:
 0.903115  0.0968846
 0.233987  0.766013</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; emissions(hmm_est)</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Distributions.Normal{Float64}}:
 Distributions.Normal{Float64}(μ=1.01550579534864, σ=0.31937379465818544)
 Distributions.Normal{Float64}(μ=1.9888727909655293, σ=0.3107545603081362)</code></pre><h2 id="Continuous-time"><a class="docs-heading-anchor" href="#Continuous-time">Continuous time</a><a id="Continuous-time-1"></a><a class="docs-heading-anchor-permalink" href="#Continuous-time" title="Permalink"></a></h2><p>Here is an example of the Baum-Welch estimation algorithm applied to a MMPP.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using MeasureTheory, PointProcesses, Random; Random.seed!(63)</code><code class="nohighlight hljs ansi" style="display:block;">MersenneTwister(63)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; tr = ContinuousMarkovChain([0.3, 0.7], [-1. 1.; 2. -2.])</code><code class="nohighlight hljs ansi" style="display:block;">ContinuousMarkovChain{Vector{Float64}, Matrix{Float64}}([0.3, 0.7], [-1.0 1.0; 2.0 -2.0])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; em1 = PoissonProcess(1., Dists.Normal(1, 1))</code><code class="nohighlight hljs ansi" style="display:block;">PoissonProcess{Distributions.Normal{Float64}, Float64}(1.0, Distributions.Normal{Float64}(μ=1.0, σ=1.0))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; em2 = PoissonProcess(2., Dists.Normal(-1, 1))</code><code class="nohighlight hljs ansi" style="display:block;">PoissonProcess{Distributions.Normal{Float64}, Float64}(2.0, Distributions.Normal{Float64}(μ=-1.0, σ=1.0))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mmpp = MarkovModulatedPoissonProcess(tr, [em1, em2])</code><code class="nohighlight hljs ansi" style="display:block;">MarkovModulatedPoissonProcess{Float64, ContinuousMarkovChain{Vector{Float64}, Matrix{Float64}}, PoissonProcess{Distributions.Normal{Float64}, Float64}}(ContinuousMarkovChain{Vector{Float64}, Matrix{Float64}}([0.3, 0.7], [-1.0 1.0; 2.0 -2.0]), PoissonProcess{Distributions.Normal{Float64}, Float64}[PoissonProcess{Distributions.Normal{Float64}, Float64}(1.0, Distributions.Normal{Float64}(μ=1.0, σ=1.0)), PoissonProcess{Distributions.Normal{Float64}, Float64}(2.0, Distributions.Normal{Float64}(μ=-1.0, σ=1.0))])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; state_history, observations = rand(mmpp, 0., 1000.)</code><code class="nohighlight hljs ansi" style="display:block;">(TemporalHistory{Int64}([0.0, 0.5876480466037021, 1.5356748506770128, 4.537875959956296, 5.870006196106273, 6.386012646954919, 7.091944542051662, 8.439485244076412, 8.689218966599741, 9.606259981637297  …  991.4104422802236, 992.081833592257, 992.3040154582011, 992.4333733842922, 992.4348752188373, 992.4761798096813, 994.6885254481947, 996.3382042159825, 996.910031842061, 997.1246594593374], [1, 2, 1, 2, 1, 2, 1, 2, 1, 2  …  2, 1, 2, 1, 2, 1, 2, 1, 2, 1], 0.0, 1000.0), TemporalHistory{Float64}([0.9876916515612817, 1.4665119090261136, 1.129504495383045, 3.558922828977815, 3.7754810932342764, 3.191774728217606, 2.8324514493080972, 1.8063293607831652, 6.916533841801616, 8.46567391212813  …  995.2292564540617, 995.1346553618032, 996.3130053551505, 995.704185585638, 996.629592259603, 996.964213868504, 997.6016205729802, 997.450858447479, 999.4277710765083, 999.0080067854727], [-0.33129769830579314, -1.0538575840037343, -0.05659955146467932, 1.0472308325360882, 0.9329757659186387, 1.4378732821038176, 0.4863651104015365, 0.14170933506245198, -0.3699585322888367, -1.5187454429881857  …  -1.2741612839448704, -0.008507016922806199, -0.6354581841391739, -1.7723956150052205, -0.37440001124030076, -0.3287330327410709, 1.9457593612637103, 1.855927748778703, 1.1902581960670837, 1.7459294633173505], 0.0, 1000.0))</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../markov/">« Markov chains</a><a class="docs-footer-nextpage" href="../utils/">Utilities »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Wednesday 25 August 2021 08:01">Wednesday 25 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
